import{d as A,r as V,c as b,a as L,o as M,b as p,e as m,f as r,u as S,g as U,t as q,h as W,n as J,i as h,j as B,F as x,k,p as T,w as E,v as G,l as R,m as D,q as F,s as P,x as Y,y as z,_ as K}from"./index-90613002.js";import{a as C,b as X}from"./QQ-701171ae.js";const Z={class:"select"},Q=["type","id","name"],ee=["for"],te=A({__name:"s-option",props:{modelValue:{type:[String,Array]},optionNum:{type:String},label:{type:String},type:{type:String},name:{type:String},value:{type:String}},emits:["update:modelValue"],setup(o,{emit:v}){const i=o,c=v,_=()=>Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),a=V(null),s=b(()=>i.modelValue===u.value),e=L({isChecked:s,inputValue:"",hasInput:!1,labelSplit:[""],selected:[]}),n=b({get(){return i.modelValue},set(t){c("update:modelValue",t)}}),u=b(()=>{let t="";return e.labelSplit.forEach(l=>{l.includes("&input")?t+=`%&${e.inputValue}%`:l.includes("&select")?t+="":t+=l}),e.selected.length>0&&(t=t+"%&select"+JSON.stringify(e.selected)+"%"),i.optionNum+"-"+t}),I=t=>{try{return t.startsWith("{")&&t.endsWith("}")?JSON.parse(t):t}catch(l){console.warn("convertJSON error",l)}},N=async()=>{var l;const t=u.value;i.type==="checkbox"&&Array.isArray(n.value)?(l=a==null?void 0:a.value)!=null&&l.checked?(n.value=n.value.filter(d=>{if(!d.startsWith(i.optionNum+"-"))return d}),await J(),n.value.push(t)):n.value=n.value.filter(d=>{if(!d.startsWith(i.optionNum+"-"))return d}):n.value=t},O=_(),j=b(()=>()=>e.labelSplit.map(t=>{var l;if(t.startsWith("&input")){const d=t.replace("&input",""),f=I(d);return h("input",{type:"text",value:e.inputValue,...f,onInput:y=>{const g=y.target;e.inputValue=g.value,a!=null&&a.value&&(a.value.checked=!0,N())}})}else if(t.startsWith("&select")){const d=t.replace("&select",""),f=I(d);return s.value?h("div",{class:"dS"},(l=f==null?void 0:f.options)==null?void 0:l.map(y=>{const g=_();return h("div",[h("input",{type:"checkbox",value:y,id:g,onInput:w=>{w.target.checked?e.selected.push(y):e.selected=e.selected.filter(H=>H!==y),N()}}),h("label",{for:g},y)])})):""}else return t}));return M(()=>{var t,l;e.labelSplit=((t=i.label)==null?void 0:t.split("%"))??[],(l=e.labelSplit)==null||l.forEach(d=>{d.startsWith("&input")&&(e.hasInput=!0)})}),(t,l)=>(p(),m("div",Z,[r("input",{type:o.type,id:S(O),name:o.name,onInput:N,ref_key:"checkBox",ref:a},null,40,Q),r("label",{for:S(O)},[U("("+q(o.optionNum)+") ",1),W(S(j))],8,ee)]))}});const ne={class:"small-q"},ae=A({__name:"s-select",props:{modelValue:{type:[String,Array]},type:{type:String,default:"single",validate:o=>["single","multiple"].includes(o)},question:{type:String},options:{type:Array},required:{type:Boolean},questionNum:{type:String},ageArea:{type:String},multiple:{type:Boolean}},emits:["update:modelValue"],setup(o,{emit:v}){B("selectAgeArea",V(""));const i=o,c=v,_=b({get(){return i.modelValue},set(a){c("update:modelValue",a)}});return(a,s)=>(p(),m("div",null,[r("h3",ne,q((o.questionNum??"")+o.question),1),(p(!0),m(x,null,k(o.options,(e,n)=>(p(),m("div",{key:e,class:"option"},[W(te,{type:o.multiple?"checkbox":"radio",name:o.questionNum,"option-num":n+1+"",label:e,modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=u=>_.value=u)},null,8,["type","name","option-num","label","modelValue"])]))),128))]))}});const $=o=>(P("data-v-7b2de61a"),o=o(),Y(),o),oe={class:"container"},se={class:"name-box"},le=$(()=>r("label",{for:"name"},"姓名：",-1)),ie={class:"name-box"},ue=$(()=>r("label",{for:""},"年齡層：",-1)),re=z('<option value="PRESCHOOL" data-v-7b2de61a>學齡前</option><option value="ELEMENTARY" data-v-7b2de61a>國小</option><option value="JUNIOR_HIGH" data-v-7b2de61a>國中</option><option value="HIGH_SCHOOL" data-v-7b2de61a>高中</option><option value="COLLEGE" data-v-7b2de61a>大專</option>',5),ce=[re],de={class:"big"},pe={key:0,class:"big-q"},me={class:"big-title"},ve=A({__name:"Survey-com",setup(o){const v=V(""),i=V("");T("selectAgeArea",i);const c=L({});C.forEach(a=>{c[a.idx]={},a.questions.forEach(s=>{s.type=="multiple"?c[a.idx][s.idx]=[]:c[a.idx][s.idx]=""})});const _=()=>{let a={};for(const e in c)for(const n in c[e]){const u=c[e][n];(u instanceof Array&&u.length>0||u&&Object.keys(u).length>0)&&(a[n]=u)}const s={userName:v.value,answer:a};X.post("/survey",s).then(e=>{console.log(e)})};return(a,s)=>(p(),m("div",oe,[r("div",se,[le,E(r("input",{type:"text",id:"name","onUpdate:modelValue":s[0]||(s[0]=e=>v.value=e)},null,512),[[G,v.value]])]),r("div",ie,[ue,E(r("select",{name:"",id:"","onUpdate:modelValue":s[1]||(s[1]=e=>i.value=e)},ce,512),[[R,i.value]])]),r("div",de,[(p(!0),m(x,null,k(S(C),e=>(p(),m(x,{key:"big"+e.idx},[e.ageArea.includes(i.value)?(p(),m("div",pe,[r("h3",me,q(e.label),1),(p(!0),m(x,null,k(e.questions,n=>(p(),D(ae,{key:n.idx,modelValue:c[e.idx][n.idx],"onUpdate:modelValue":u=>c[e.idx][n.idx]=u,type:n.type,options:n.option,questionNum:n.idx,question:n.question,multiple:n.type=="multiple"},null,8,["modelValue","onUpdate:modelValue","type","options","questionNum","question","multiple"]))),128))])):F("",!0)],64))),128))]),r("div",{class:"button-box"},[r("button",{class:"btn btn-submit",onClick:_},"送出")])]))}});const he=K(ve,[["__scopeId","data-v-7b2de61a"]]);export{he as default};
