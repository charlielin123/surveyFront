import{d as A,r as x,c as S,a as W,o as M,b as m,e as v,f as u,u as N,g as U,t as I,h as $,n as B,i as g,j as J,F as k,k as q,p as T,w as C,v as G,l as R,m as D,q as F,s as P,x as Y,y as z,_ as K}from"./index-eb71f141.js";import{a as L,b as X}from"./QQ-4c79c977.js";const Z={class:"select"},Q=["type","id","name"],ee=["for"],te=A({__name:"s-option",props:{modelValue:{type:[String,Array]},optionNum:{type:String},label:{type:String},type:{type:String},name:{type:String},value:{type:String}},emits:["update:modelValue"],setup(o,{emit:_}){const s=o,c=_,f=()=>Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),r=x(null),l=S(()=>s.modelValue===a.value),e=W({isChecked:l,inputValue:"",hasInput:!1,labelSplit:[""],selected:[]}),n=S({get(){return s.modelValue},set(t){c("update:modelValue",t)}}),a=S(()=>{let t="";return e.labelSplit.forEach(i=>{i.includes("&input")?t+=`%&${e.inputValue}%`:i.includes("&select")?t+="":t+=i}),e.selected.length>0&&(t=t+"%&select"+JSON.stringify(e.selected)+"%"),s.optionNum+"-"+t}),y=t=>{try{return t.startsWith("{")&&t.endsWith("}")?JSON.parse(t):t}catch(i){console.warn("convertJSON error",i)}},p=async()=>{var i;const t=a.value;s.type==="checkbox"&&Array.isArray(n.value)?(i=r==null?void 0:r.value)!=null&&i.checked?(n.value=n.value.filter(d=>{if(!d.startsWith(s.optionNum+"-"))return d}),await B(),n.value.push(t)):n.value=n.value.filter(d=>{if(!d.startsWith(s.optionNum+"-"))return d}):n.value=t},E=f(),j=S(()=>()=>e.labelSplit.map(t=>{var i;if(t.startsWith("&input")){const d=t.replace("&input",""),b=y(d);return g("input",{type:"text",value:e.inputValue,...b,onInput:h=>{const V=h.target;e.inputValue=V.value,r!=null&&r.value&&(r.value.checked=!0,p())}})}else if(t.startsWith("&select")){const d=t.replace("&select",""),b=y(d);return l.value?g("div",{class:"dS"},(i=b==null?void 0:b.options)==null?void 0:i.map(h=>{const V=f();return g("div",[g("input",{type:"checkbox",value:h,id:V,onInput:w=>{w.target.checked?e.selected.push(h):e.selected=e.selected.filter(H=>H!==h),p()}}),g("label",{for:V},h)])})):""}else return t}));return M(()=>{var t,i;e.labelSplit=((t=s.label)==null?void 0:t.split("%"))??[],(i=e.labelSplit)==null||i.forEach(d=>{d.startsWith("&input")&&(e.hasInput=!0)})}),(t,i)=>(m(),v("div",Z,[u("input",{type:o.type,id:N(E),name:o.name,onInput:p,ref_key:"checkBox",ref:r},null,40,Q),u("label",{for:N(E)},[U("("+I(o.optionNum)+") ",1),$(N(j))],8,ee)]))}});const ne={class:"small-q"},oe=A({__name:"s-select",props:{modelValue:{type:[String,Array]},type:{type:String,default:"single",validate:o=>["single","multiple"].includes(o)},question:{type:String},options:{type:Array},required:{type:Boolean},questionNum:{type:String},ageArea:{type:String},multiple:{type:Boolean}},emits:["update:modelValue"],setup(o,{emit:_}){J("selectAgeArea",x(""));const s=o,c=_,f=S({get(){return s.modelValue},set(r){c("update:modelValue",r)}});return(r,l)=>(m(),v("div",null,[u("h3",ne,I((o.questionNum??"")+o.question),1),(m(!0),v(k,null,q(o.options,(e,n)=>(m(),v("div",{key:e,class:"option"},[$(te,{type:o.multiple?"checkbox":"radio",name:o.questionNum,"option-num":n+1+"",label:e,modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=a=>f.value=a)},null,8,["type","name","option-num","label","modelValue"])]))),128))]))}});const O=o=>(P("data-v-63d4ebf5"),o=o(),Y(),o),ae={class:"container"},se={class:"reqBox"},le=O(()=>u("h2",null,"兒少生活樣態訪視檢視清單",-1)),ie={class:"name-box"},ue=O(()=>u("label",{for:"name"},"姓名：",-1)),re={class:"name-box"},ce=O(()=>u("label",{for:""},"年齡層：",-1)),de=z('<option value="" data-v-63d4ebf5>請選擇年齡層</option><option value="PRESCHOOL" data-v-63d4ebf5>幼兒園</option><option value="ELEMENTARY" data-v-63d4ebf5>國小</option><option value="JUNIOR_HIGH" data-v-63d4ebf5>國中</option><option value="HIGH_SCHOOL" data-v-63d4ebf5>高中</option><option value="COLLEGE" data-v-63d4ebf5>大專</option>',6),pe=[de],me={class:"big"},ve={key:0,class:"big-q"},_e={class:"big-title"},fe=A({__name:"Survey-com",setup(o){const _=x(""),s=x("");T("selectAgeArea",s);const c=W({});L.forEach(l=>{c[l.idx]={},l.questions.forEach(e=>{e.type=="multiple"?c[l.idx][e.idx]=[]:c[l.idx][e.idx]=""})});const f=x(null),r=()=>{var n;let l={};if(!_.value){alert("請輸入姓名"),(n=f.value)==null||n.focus();return}if(!s.value){alert("請選擇年齡層");return}for(const a in c)for(const y in c[a]){const p=c[a][y];(p instanceof Array&&p.length>0||p&&Object.keys(p).length>0)&&(l[y]=p)}const e={userName:_.value,answer:l};X.post("/survey",e).then(a=>{alert("送出成功"),location.reload()})};return(l,e)=>(m(),v("div",ae,[u("div",se,[le,u("div",ie,[ue,C(u("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=n=>_.value=n),ref_key:"nameInput",ref:f},null,512),[[G,_.value]])]),u("div",re,[ce,C(u("select",{name:"",id:"","onUpdate:modelValue":e[1]||(e[1]=n=>s.value=n)},pe,512),[[R,s.value]])])]),u("div",me,[(m(!0),v(k,null,q(N(L),n=>(m(),v(k,{key:"big"+n.idx},[n.ageArea.includes(s.value)?(m(),v("div",ve,[u("h3",_e,I(n.label),1),(m(!0),v(k,null,q(n.questions,a=>(m(),D(oe,{key:a.idx,modelValue:c[n.idx][a.idx],"onUpdate:modelValue":y=>c[n.idx][a.idx]=y,type:a.type,options:a.option,questionNum:a.idx,question:a.question,multiple:a.type=="multiple"},null,8,["modelValue","onUpdate:modelValue","type","options","questionNum","question","multiple"]))),128))])):F("",!0)],64))),128))]),u("div",{class:"button-box"},[u("button",{class:"btn btn-submit",onClick:r},"送出")])]))}});const ge=K(fe,[["__scopeId","data-v-63d4ebf5"]]);export{ge as default};
